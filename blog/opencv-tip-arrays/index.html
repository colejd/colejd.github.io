<!DOCTYPE html><html lang="en-US"><head><meta charSet="utf-8" /><meta httpEquiv="x-ua-compatible" content="ie=edge" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><style data-href="/styles.382681eb70d74ec7e7ed.css" data-identity="gatsby-global-css">/*
! tailwindcss v3.1.8 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;tab-size:4}body{line-height:inherit}hr{border-top-width:1px;color:inherit}abbr:where([title]){text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;padding:0}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-search-decoration{-webkit-appearance:none}summary{display:list-item}blockquote,dd,dl,fieldset,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.container{width:100%}@media (min-width:65ch){.container{max-width:65ch}}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}body{--tw-bg-opacity:1;background-color:rgb(250 250 250/var(--tw-bg-opacity))}@media (prefers-color-scheme:dark){body{background-color:#202020!important}}a:hover{text-decoration-line:underline}a{--tw-text-opacity:1!important;color:rgb(249 115 22/var(--tw-text-opacity))!important}@media (prefers-color-scheme:dark){a{--tw-text-opacity:1!important;color:rgb(196 181 253/var(--tw-text-opacity))!important}}p+pre{margin-bottom:1.5rem!important}div.gatsby-highlight+p{margin-top:1.45rem}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;box-sizing:border-box;font:112.5%/1.45em sans-serif;overflow-y:scroll}body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:rgba(0,0,0,.8);margin:0}@media (prefers-color-scheme:dark){body{--tw-text-opacity:1!important;color:rgb(255 255 255/var(--tw-text-opacity))!important}}body{word-wrap:break-word;-moz-font-feature-settings:"kern","liga","clig","calt";-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt";font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-kerning:normal;font-weight:400}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{-webkit-text-decoration-skip:objects;background-color:transparent}a:active,a:hover{outline-width:0}abbr[title]{--tw-border-opacity:1;border-bottom:1px dotted rgba(0,0,0,.5);border-color:rgb(255 255 255/var(--tw-border-opacity));cursor:help;text-decoration:none}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:2.25rem;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}mark{background-color:#ff0;color:#000}@media (prefers-color-scheme:dark){mark{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none;margin:0 0 1.45rem;max-width:100%;padding:0}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace;font-size:1em}figure{margin:0 0 1.45rem;padding:0}hr{--tw-border-opacity:1;background:clear;border-top:2px dotted;border-color:rgb(253 186 116/var(--tw-border-opacity));box-sizing:content-box;height:0;margin:0 0 calc(1.45rem - 1px);overflow:visible;padding:0}@media (prefers-color-scheme:dark){hr{--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity))}}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 0 1.45rem;padding:0}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}*,:after,:before{box-sizing:inherit}h2{font-size:1.62671rem}h2,h3{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h3{font-size:1.38316rem}h4{font-size:1rem}h4,h5{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;line-height:1.1;margin:0 0 1.45rem;padding:0;text-rendering:optimizeLegibility}h5{font-size:.85028rem}h6{color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-size:.78405rem;font-weight:700;line-height:1.1;text-rendering:optimizeLegibility}h6,hgroup{margin:0 0 1.45rem;padding:0}ol,ul{list-style-image:none;list-style-position:outside;margin:0 0 1.45rem 1.45rem;padding:0}dd,dl,p,table{margin:0 0 1.45rem;padding:0}table{border-collapse:collapse;font-size:1rem;line-height:1.45rem;width:100%}blockquote{margin:0 1.45rem 1.45rem;padding:0}address,form,iframe,noscript{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-bottom:.725rem;margin-left:1.45rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code{font-size:.875rem;font-weight:600;line-height:1.45rem}h1 code,h2 code,h3 code,h4 code,h5 code,h6 code{font-size:unset}kbd,samp{font-size:.85rem;line-height:1.45rem}abbr{border-bottom:1px dotted rgba(0,0,0,.5)}@media (prefers-color-scheme:dark){abbr{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}}abbr{cursor:help}acronym{border-bottom:1px dotted rgba(0,0,0,.5)}@media (prefers-color-scheme:dark){acronym{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}}acronym{cursor:help}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12)}@media (prefers-color-scheme:dark){td,th{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}}td,th{font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}tt{border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:.2em 0}@media only screen and (max-width:480px){html{font-size:100%}}ul.bullet-list>li:before{content:"・";float:left;margin:0 0 0 -1.25rem;width:1.25rem}.gatsby-image-fillwidth.gatsby-image-wrapper{width:100%}.gatsby-image-fillwidth *{max-width:unset!important}.prose-slate{--tw-prose-body:#334155;--tw-prose-headings:#0f172a;--tw-prose-lead:#475569;--tw-prose-links:#0f172a;--tw-prose-bold:#0f172a;--tw-prose-counters:#64748b;--tw-prose-bullets:#cbd5e1;--tw-prose-hr:#e2e8f0;--tw-prose-quotes:#0f172a;--tw-prose-quote-borders:#e2e8f0;--tw-prose-captions:#64748b;--tw-prose-code:#0f172a;--tw-prose-pre-code:#e2e8f0;--tw-prose-pre-bg:#1e293b;--tw-prose-th-borders:#cbd5e1;--tw-prose-td-borders:#e2e8f0;--tw-prose-invert-body:#cbd5e1;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#94a3b8;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#94a3b8;--tw-prose-invert-bullets:#475569;--tw-prose-invert-hr:#334155;--tw-prose-invert-quotes:#f1f5f9;--tw-prose-invert-quote-borders:#334155;--tw-prose-invert-captions:#94a3b8;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#cbd5e1;--tw-prose-invert-pre-bg:rgba(0,0,0,.5);--tw-prose-invert-th-borders:#475569;--tw-prose-invert-td-borders:#334155}@media (prefers-color-scheme:light){.prose-slate p{color:var(--tw-prose-body)}.prose-slate code{color:var(--tw-prose-code)}.prose-slate h2,.prose-slate h3,.prose-slate h4,.prose-slate h5,.prose-slate h6{color:var(--tw-prose-headings)}.prose-slate strong{color:var(--tw-prose-bold)}}@media (prefers-color-scheme:dark){.prose-slate p{color:var(--tw-prose-invert-body)}.prose-slate code{color:var(--tw-prose-invert-code)}.prose-slate h2,.prose-slate h3,.prose-slate h4,.prose-slate h5,.prose-slate h6{color:var(--tw-prose-invert-headings)}.prose-slate strong{color:var(--tw-prose-invert-bold)}}.sr-only{clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.static{position:static}.absolute{position:absolute}.relative{position:relative}.mb-8{margin-bottom:2rem}.mb-1{margin-bottom:.25rem}.mt-0{margin-top:0}.mb-0{margin-bottom:0}.mt-2{margin-top:.5rem}.mr-0{margin-right:0}.mb-20{margin-bottom:5rem}.ml-4{margin-left:1rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.block{display:block}.inline{display:inline}.flex{display:flex}.hidden{display:none}.h-10{height:2.5rem}.w-full{width:100%}.w-auto{width:auto}.flex-shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.select-none{user-select:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.justify-center{justify-content:center}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.p-1{padding:.25rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-4{padding-bottom:1rem}.pt-4{padding-top:1rem}.text-left{text-align:left}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.italic{font-style:italic}.leading-loose{line-height:2}.underline{text-decoration-line:underline}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgba(0,0,0,.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.blur{--tw-blur:blur(8px)}.blur,.grayscale{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.grayscale{--tw-grayscale:grayscale(100%)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.focus\:not-sr-only:focus{clip:auto;height:auto;margin:0;overflow:visible;padding:0;position:static;white-space:normal;width:auto}@media (min-width:1024px){.lg\:mr-32{margin-right:8rem}}@media (min-width:1536px){.\32xl\:flex{display:flex}.\32xl\:flex-row{flex-direction:row}.\32xl\:justify-center{justify-content:center}}@media (min-width:80ch){.columnbreak\:top-2{top:.5rem}.columnbreak\:left-2{left:.5rem}.columnbreak\:mb-4{margin-bottom:1rem}.columnbreak\:hidden{display:none}.columnbreak\:w-28{width:7rem}.columnbreak\:flex-row{flex-direction:row}.columnbreak\:flex-col{flex-direction:column}.columnbreak\:py-8{padding-bottom:2rem;padding-top:2rem}.columnbreak\:py-0{padding-bottom:0;padding-top:0}.columnbreak\:text-5xl{font-size:3rem;line-height:1}}.main-column-interior{max-width:65ch}@media (min-width:calc(65ch + 2.5rem + 2.5rem + 7rem + 10rem)){.main-column-interior{width:65ch}}.main-column{min-width:0}#thursday-button{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}@media (prefers-color-scheme:dark){#thursday-button{--tw-bg-opacity:1!important;background-color:rgb(34 197 94/var(--tw-bg-opacity))!important}}#thursday-button{border-radius:.25rem}@media (prefers-color-scheme:dark){#thursday-button{--tw-text-opacity:1!important;color:rgb(0 0 0/var(--tw-text-opacity))!important}}#thursday-button{transition:visibility 0s,opacity .25s ease-in}.emoji-bullet:before{background-color:unset!important;margin-left:-1.5rem;margin-right:.5rem;top:unset!important}.emoji-bullet-pizza:before{content:"🍕"!important}.emoji-bullet-film-reel:before{content:"📽️"!important}.emoji-bullet-sunglasses:before{content:"🕶️"!important}.emoji-bullet-car:before{content:"🚙"!important}.emoji-bullet-signpost:before{content:"🚏"!important}.emoji-bullet-light-bulb:before{content:"💡"!important}.emoji-bullet-robot:before{content:"🤖"!important}.screenshots{height:400px;overflow-x:scroll;overflow-y:hidden;scroll-snap-type:x mandatory;white-space:nowrap}.screenshots>.screenshot{display:inline-block;height:100%;scroll-snap-align:center}.screenshots>:not(:first-child){margin-left:1em}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#f8f8f2;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-shadow:0 1px rgba(0,0,0,.3)}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#8292a2}.token.punctuation{color:#f8f8f2}.token.namespace{opacity:.7}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#f92672}.token.boolean,.token.number{color:#ae81ff}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#a6e22e}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#f8f8f2}.token.atrule,.token.attr-value,.token.class-name,.token.function{color:#e6db74}.token.keyword{color:#66d9ef}.token.important,.token.regex{color:#fd971f}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}pre[class*=language-].line-numbers{counter-reset:linenumber;padding-left:3.8em;position:relative}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{border-right:1px solid #999;font-size:100%;left:-3.8em;letter-spacing:-1px;pointer-events:none;position:absolute;top:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:3em}.line-numbers-rows>span{counter-increment:linenumber;display:block}.line-numbers-rows>span:before{color:#999;content:counter(linenumber);display:block;padding-right:.8em;text-align:right}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.command-line-prompt>span:before{content:" ";display:block;opacity:.7;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}p{margin-bottom:1.45rem}p+h2{margin-top:4rem}.hero-image{margin-bottom:2rem}article span.gatsby-resp-image-wrapper{margin-bottom:3rem;margin-top:3rem}@media (prefers-color-scheme:dark){.gatsby-highlight pre[class*=language-]{background-color:transparent}}.gatsby-highlight pre[class*=language-]{float:left;margin:0;min-width:100%;overflow:initial;padding:0}.gatsby-highlight{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em 0}.gatsby-highlight-code-line{background-color:hsla(0,0%,93%,.082);display:block}.gatsby-highlight pre[class*=language-].line-numbers{padding-left:2.8em}.gatsby-highlight>div[class*=language-]{margin-bottom:1.45rem}.gatsby-highlight{margin-left:-1.25rem;margin-right:-1.25rem}.gatsby-highlight pre{border-radius:0}@media (min-width:80ch){.gatsby-highlight{margin-left:0;margin-right:0}.gatsby-highlight pre{border-radius:.5rem}}:root{--mono-1:#383a42;--mono-2:#696c77;--mono-3:#a0a1a7;--hue-1:#0184bc;--hue-2:#4078f2;--hue-3:#a626a4;--hue-4:#50a14f;--hue-5:#e45649;--hue-5-2:#ca1243;--hue-6:#b76b01;--hue-6-2:#cb7701;--syntax-fg:#383a42;--syntax-bg:clear;--syntax-gutter:#9d9d9f;--syntax-guide:rgba(56,58,66,.2);--syntax-accent:#526fff;--syntax-selection-color:#e5e5e6;--syntax-gutter-background-color-selected:#e5e5e6;--syntax-cursor-line:rgba(56,58,66,.05);--prism-previewer-border:hsl(0,0,95%);--prism-previewer-background:#fff}@media (prefers-color-scheme:dark){:root{--mono-1:#abb2bf;--mono-2:#828997;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61afef;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e5c07b;--syntax-fg:#abb2bf;--syntax-bg:clear;--syntax-gutter:#636d83;--syntax-guide:rgba(171,178,191,.15);--syntax-accent:#528bff;--syntax-selection-color:#3e4451;--syntax-gutter-background-color-selected:#3a3f4b;--syntax-cursor-line:rgba(153,187,255,.04);--prism-previewer-border:#262931;--prism-previewer-background:#31363f}}code[class*=language-],pre[class*=language-]{background:var(--syntax-bg);color:var(--syntax-fg);direction:ltr;font-family:Fira Code,Fira Mono,Menlo,Consolas,DejaVu Sans Mono,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{background:var(--syntax-selection-color);color:inherit}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection{background:var(--syntax-selection-color);color:inherit}pre[class*=language-]{border-radius:.3em;margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.2em .3em;white-space:normal}.token.cdata,.token.comment,.token.prolog{color:var(--mono-3)}.token.doctype,.token.entity,.token.punctuation{color:var(--syntax-fg)}.token.atrule,.token.attr-name,.token.boolean,.token.class-name,.token.constant,.token.number{color:var(--hue-6)}.token.keyword{color:var(--hue-3)}.token.deleted,.token.important,.token.property,.token.symbol,.token.tag{color:var(--hue-5)}.token.attr-value,.token.attr-value>.token.punctuation,.token.builtin,.token.char,.token.inserted,.token.regex,.token.selector,.token.string{color:var(--hue-4)}.token.function,.token.operator,.token.variable{color:var(--hue-2)}.token.url{color:var(--hue-1)}.token.attr-value>.token.punctuation.attr-equals,.token.special-attr>.token.attr-value>.token.value.css{color:var(--syntax-fg)}.language-css .token.selector{color:var(--hue-5)}.language-css .token.property{color:var(--syntax-fg)}.language-css .token.function,.language-css .token.url>.token.function{color:var(--hue-1)}.language-css .token.url>.token.string.url{color:var(--hue-4)}.language-css .token.atrule .token.rule,.language-css .token.important,.language-javascript .token.operator{color:var(--hue-3)}.language-javascript .token.template-string>.token.interpolation>.token.interpolation-punctuation.punctuation{color:#ca1243}.language-json .token.operator{color:var(--syntax-fg)}.language-json .token.null.keyword{color:var(--hue-6)}.language-markdown .token.url,.language-markdown .token.url-reference.url>.token.string,.language-markdown .token.url>.token.operator{color:var(--syntax-fg)}.language-markdown .token.url>.token.content{color:var(--hue-2)}.language-markdown .token.url-reference.url,.language-markdown .token.url>.token.url{color:var(--hue-1)}.language-markdown .token.blockquote.punctuation,.language-markdown .token.hr.punctuation{color:var(--mono-3);font-style:italic}.language-markdown .token.code-snippet{color:var(--hue-4)}.language-markdown .token.bold .token.content{color:var(--hue-6)}.language-markdown .token.italic .token.content{color:var(--hue-3)}.language-markdown .token.list.punctuation,.language-markdown .token.strike .token.content,.language-markdown .token.strike .token.punctuation,.language-markdown .token.title.important>.token.punctuation{color:var(--hue-5)}.token.bold{font-weight:700}.token.comment,.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.8}.token.token.cr:before,.token.token.lf:before,.token.token.space:before,.token.token.tab:not(:empty):before{color:var(--syntax-guide)}div.code-toolbar>.toolbar.toolbar>.toolbar-item{margin-right:.4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span{background:var(--syntax-gutter-background-color-selected);border-radius:.3em;color:var(--mono-2);padding:.1em .4em}div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>a:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>button:hover,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:focus,div.code-toolbar>.toolbar.toolbar>.toolbar-item>span:hover{background:var(--syntax-selection-color);color:var(--syntax-fg)}.line-highlight.line-highlight{background:var(--syntax-cursor-line)}.line-highlight.line-highlight:before,.line-highlight.line-highlight[data-end]:after{background:var(--syntax-gutter-background-color-selected);border-radius:.3em;box-shadow:0 2px 0 0 rgba(0,0,0,.2);color:var(--syntax-fg);padding:.1em .6em}pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows>span:hover:before{background-color:var(--syntax-cursor-line)}.command-line .command-line-prompt,.line-numbers.line-numbers .line-numbers-rows{border-right-color:var(--syntax-guide)}.command-line .command-line-prompt>span:before,.line-numbers .line-numbers-rows>span:before{color:var(--syntax-gutter)}.rainbow-braces .token.token.punctuation.brace-level-1,.rainbow-braces .token.token.punctuation.brace-level-5,.rainbow-braces .token.token.punctuation.brace-level-9{color:var(--hue-5)}.rainbow-braces .token.token.punctuation.brace-level-10,.rainbow-braces .token.token.punctuation.brace-level-2,.rainbow-braces .token.token.punctuation.brace-level-6{color:var(--hue-4)}.rainbow-braces .token.token.punctuation.brace-level-11,.rainbow-braces .token.token.punctuation.brace-level-3,.rainbow-braces .token.token.punctuation.brace-level-7{color:var(--hue-2)}.rainbow-braces .token.token.punctuation.brace-level-12,.rainbow-braces .token.token.punctuation.brace-level-4,.rainbow-braces .token.token.punctuation.brace-level-8{color:var(--hue-3)}pre.diff-highlight>code .token.token.deleted:not(.prefix),pre>code.diff-highlight .token.token.deleted:not(.prefix){background-color:rgba(255,82,102,.15)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.deleted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.deleted:not(.prefix)::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.deleted:not(.prefix)::selection{background-color:rgba(251,86,105,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix),pre>code.diff-highlight .token.token.inserted:not(.prefix){background-color:rgba(25,255,91,.15)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::-moz-selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::-moz-selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection{background-color:rgba(56,224,98,.25)}pre.diff-highlight>code .token.token.inserted:not(.prefix) ::selection,pre.diff-highlight>code .token.token.inserted:not(.prefix)::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix) ::selection,pre>code.diff-highlight .token.token.inserted:not(.prefix)::selection{background-color:rgba(56,224,98,.25)}.prism-previewer-gradient.prism-previewer-gradient div,.prism-previewer.prism-previewer:before{border-color:var(--prism-previewer-border)}.prism-previewer-color.prism-previewer-color:before,.prism-previewer-easing.prism-previewer-easing:before,.prism-previewer-gradient.prism-previewer-gradient div{border-radius:.3em}.prism-previewer.prism-previewer:after{border-top-color:var(--prism-previewer-border)}.prism-previewer-flipped.prism-previewer-flipped.after{border-bottom-color:var(--prism-previewer-border)}.prism-previewer-angle.prism-previewer-angle:before,.prism-previewer-easing.prism-previewer-easing,.prism-previewer-time.prism-previewer-time:before{background:var(--prism-previewer-background)}.prism-previewer-angle.prism-previewer-angle circle,.prism-previewer-time.prism-previewer-time circle{stroke:var(--syntax-fg);stroke-opacity:1}.prism-previewer-easing.prism-previewer-easing circle,.prism-previewer-easing.prism-previewer-easing line,.prism-previewer-easing.prism-previewer-easing path{stroke:var(--syntax-fg)}.prism-previewer-easing.prism-previewer-easing circle{fill:transparent}.project-container{margin:1rem auto;padding-bottom:100%;position:relative;width:100%}.project-container canvas{position:absolute}.project-container.shadowed{box-shadow:0 0 12px 0 rgba(0,0,0,.2)}.project-container.break-aspect-on-mobile{padding-bottom:75vh}@media (min-width:80ch){.project-container.break-aspect-on-mobile{padding-bottom:100%}}</style><meta name="generator" content="Gatsby 3.14.6" /><title data-react-helmet>OpenCV, InputArray, OutputArray, and You | Jon's Website</title><meta data-react-helmet name="description" content="Improve your code with *one easy trick!*" /><meta data-react-helmet name="og:title" content="OpenCV, InputArray, OutputArray, and You" /><meta data-react-helmet name="og:description" content="Improve your code with *one easy trick!*" /><meta data-react-helmet name="og:type" content="article" /><meta data-react-helmet name="og:site_name" content="Jon's Website" /><meta data-react-helmet name="twitter:card" content="summary" /><meta data-react-helmet name="twitter:creator" content /><meta data-react-helmet name="twitter:title" content="OpenCV, InputArray, OutputArray, and You" /><meta data-react-helmet name="twitter:description" content="Improve your code with *one easy trick!*" /><meta data-react-helmet name="og:article:published_time" content="2019-03-13T00:00:00.000Z" /><meta data-react-helmet name="og:article:modified_time" /><script data-react-helmet type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://jons.website/blog/opencv-tip-arrays/"},"inLanguage":"en-US","author":{"@type":"Person","name":"Jonathan Cole","givenName":"Jonathan","familyName":"Cole","sameAs":["https://github.com/colejd"]},"publisher":{"@type":"Person","name":"Jonathan Cole","givenName":"Jonathan","familyName":"Cole","sameAs":["https://github.com/colejd"],"logo":{"@type":"ImageObject","url":"https://jons.website/assets/images/avatar.png"}},"datePublished":"2019-03-13T00:00:00.000Z","dateModified":null,"isAccessibleForFree":true,"keywords":"opencv inputarray outputarray c++ tip software programming development","headline":"OpenCV, InputArray, OutputArray, and You","description":"Improve your code with *one easy trick!*"}</script><link rel="canonical" href="https://jons.website/blog/opencv-tip-arrays/" data-baseprotocol="https:" data-basehost="jons.website" /><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=ff44750de9a165d6ee91c26a80293194" type="image/png" /><link rel="manifest" href="/manifest.webmanifest" crossOrigin="anonymous" /><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=ff44750de9a165d6ee91c26a80293194" /><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=ff44750de9a165d6ee91c26a80293194" /><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap.xml" /><link rel="alternate" type="application/rss+xml" title="Jon's Blog" href="/rss.xml" /><link as="script" rel="preload" href="/webpack-runtime-a1410d557796a525b231.js" /><link as="script" rel="preload" href="/framework-25add98bf20cee191708.js" /><link as="script" rel="preload" href="/app-9ccce7c97793f07a9b8f.js" /><link as="script" rel="preload" href="/commons-7a18c21993c24c3c9205.js" /><link as="script" rel="preload" href="/component---src-templates-blog-post-js-313d8220c9e9c9688b4d.js" /><link as="fetch" rel="preload" href="/page-data/blog/opencv-tip-arrays/page-data.json" crossOrigin="anonymous" /><link as="fetch" rel="preload" href="/page-data/sq/d/2780354278.json" crossOrigin="anonymous" /><link as="fetch" rel="preload" href="/page-data/sq/d/3903778693.json" crossOrigin="anonymous" /><link as="fetch" rel="preload" href="/page-data/app-data.json" crossOrigin="anonymous" /></head><body><div id="___gatsby"><div style="outline: none;" tabIndex="-1" id="gatsby-focus-wrapper"><div class="prose-slate w-full 2xl:flex 2xl:flex-row 2xl:justify-center"><div id="outer-column" class="flex flex-col columnbreak:flex-row"><a style="position: absolute !important;" href="#main-content" class="sr-only focus:not-sr-only columnbreak:top-2 columnbreak:left-2">Skip to main content</a><nav id="sidebar" aria-label="Main Navigation" class="px-5 columnbreak:py-8 flex-shrink-0 columnbreak:w-28"><div class="flex flex-row columnbreak:flex-col text-left py-2 columnbreak:py-0 flex-wrap"><a href="/">About Me</a><span aria-hidden="true" class="columnbreak:hidden px-1 select-none">•</span><a href="/blog/">Blog</a><span aria-hidden="true" class="columnbreak:hidden px-1 select-none">•</span><a href="/projects/">Projects</a><span aria-hidden="true" class="columnbreak:hidden px-1 select-none">•</span><a href="/apps/">Apps</a></div></nav><div aria-label="Main Content" class="main-column flex-grow mr-0 lg:mr-32 px-5 py-8 mb-20"><div class="main-column-interior flex flex-col"><main id="main-content"><article class="prose-slate"><header><h1 class="text-3xl columnbreak:text-5xl mb-2 columnbreak:mb-4">OpenCV, InputArray, OutputArray, and You</h1><p class="mb-0"><em>Improve your code with *one easy trick!*</em></p><p class="text-sm leading-loose mb-4"><time dateTime="2019-03-13">March 13th, 2019</time></p><hr /></header><section class="markdown"><p>When you’re writing OpenCV code in C++, you’ll eventually want to pass whatever <code>Mat</code> objects you have into a function or a class method. For the purposes of this post, let’s say we want to write a utility function that prepares a BGR888 <code>Mat</code> for edge detection. This typically involves converting the image to grayscale, as well as blurring it to remove superficial details.</p>
<p>It’s tempting to write the following function signature:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Revision 1</span>
Mat <span class="token function">preprocess</span><span class="token punctuation">(</span><span class="token keyword">const</span> Mat<span class="token operator">&amp;</span> input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Mat gray<span class="token punctuation">,</span> output<span class="token punctuation">;</span>
  <span class="token function">cvtColor</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> gray<span class="token punctuation">,</span> COLOR_BGR2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">blur</span><span class="token punctuation">(</span>gray<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This is good C++ code; we pass a reference to the input <code>Mat</code> so that we don’t incur a copy, and we use <code>const</code> to mark the reference as read-only. However, OpenCV provides some utilities that we can use to improve this function.</p>
<p><code>Mat</code> is not the only container for representing an image in OpenCV. If you’re looking to leverage OpenCV’s <a href="https://www.learnopencv.com/opencv-transparent-api/">Transparent API</a> for GPU acceleration, you’ll want to use <code>UMat</code> as your container instead. If you have an existing codebase full of utility functions written like above, you’re going to have to make copies that take a <code>UMat</code> reference if you want to use those.</p>
<p>Fortunately, OpenCV has a solution to this problem in the form of the <a href="https://docs.opencv.org/4.0.1/d4/d32/classcv_1_1__InputArray.html#details"><code>InputArray</code></a> proxy class. As per the docs, <code>InputArray</code> lets you pass in a <code>Mat</code>, <code>UMat</code>, or even a <code>std::vector</code>, among others.</p>
<p>Here’s what our function looks like using <code>InputArray</code>:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Revision 2</span>
Mat <span class="token function">preprocess</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Mat gray<span class="token punctuation">,</span> output<span class="token punctuation">;</span>
  <span class="token function">cvtColor</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> gray<span class="token punctuation">,</span> COLOR_BGR2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">blur</span><span class="token punctuation">(</span>gray<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> output<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Note that we aren’t passing a reference to <code>input</code>. <code>InputArray</code> internally typedefs as a reference, so that’s taken care of for you; that said, <code>Mat</code> and <code>UMat</code> are internally backed by smart pointers, so we don’t need to worry about getting a reference anyway! Using <code>InputArray</code> also has the nice benefit of making your image read-only as far as the OpenCV SDK is concerned, which helps the compiler find issues and makes your code easier to read.</p>
<p>OpenCV provides a similar proxy class called <a href="https://docs.opencv.org/4.0.1/d2/d9e/classcv_1_1__OutputArray.html#details"><code>OutputArray</code></a>, which wraps the same types but is treated as write-only. Let’s rewrite <code>preprocess()</code> with that:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Revision 3</span>
<span class="token keyword">void</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">,</span> OutputArray output<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Mat gray<span class="token punctuation">;</span>
  <span class="token function">cvtColor</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> gray<span class="token punctuation">,</span> COLOR_BGR2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">blur</span><span class="token punctuation">(</span>gray<span class="token punctuation">,</span> output<span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now instead of returning a new <code>Mat</code> object, whatever we pass into <code>output</code> will be written to.</p>
<p>Why would we want to do this? Well, when you’re writing computer vision code, you need to be careful about how your image data is being passed around. After all, the images you’re passing around are uncompressed; a 4000x4000 image in BGR888 format would take around 48 megabytes of space in RAM. That’s not a lot, but it adds up fast, particularly if you’re parallelizing or running on a mobile platform. If we gave that image to Revision 2 of the <code>preprocess()</code> function, we would be allocating two copies of the image; one temporary (<code>gray</code>) and one that we keep and return ( <code>output</code>).</p>
<p>With Revision 3, we’ve moved the decision to allocate the output from inside of the function to wherever it gets called. If you want a copy, call <code>preprocess(someMat, someOtherMat)</code>. If you want to overwrite the original <code>Mat</code>, just call <code>preprocess(someMat, someMat)</code>, using the same object for the input and the output. If you’ve wondered why so many of OpenCV’s functions write outputs to an <code>OutputArray</code> parameter instead of returning a <code>Mat</code>, this is why!</p>
<p>Now let’s say we <em>always</em> want <code>preprocess()</code> to operate in-place. We can make use of OpenCV’s <code>InputOutputArray</code> to completely avoid allocating new images in <code>preprocess()</code> and make the function a little easier to read:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token comment">// Revision 4</span>
<span class="token keyword">void</span> <span class="token function">preprocess</span><span class="token punctuation">(</span>InputOutputArray input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">cvtColor</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> input<span class="token punctuation">,</span> COLOR_BGR2GRAY<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">blur</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> input<span class="token punctuation">,</span> <span class="token function">Size</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Easy.</p>
<p>As a footnote, you might be wondering to yourself, “Why not just avoid all of this and use <code>UMat</code> everywhere?” The simple answer is that OpenCV functions that consume a <code>UMat</code> will run on the GPU if it can, falling back on the CPU if not. If you pass a <code>Mat</code>, it will always run on the CPU. Sometimes you’ll want to explicitly force an algorithm to run on the CPU (or bail on using <code>UMat</code> when you run into some platform-specific bug), so having the ability to quickly switch between the two will save you a lot of time.</p>
<h2 id="optional-outputs-with-inputarray-and-outputarray" style="position:relative;"><a href="#optional-outputs-with-inputarray-and-outputarray" aria-label="optional outputs with inputarray and outputarray permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Optional outputs with <code>InputArray</code> and <code>OutputArray</code></h2>
<p>A nice trick you can do with <code>InputArray</code> is making parameters optional. Let’s suppose we want to write a function that takes a <code>Mat</code> and a mask (also a <code>Mat</code>):</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">someFunction</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">,</span>
        OutputArray output<span class="token punctuation">,</span>
        InputArray mask<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. Use the mask on the input</span>
  <span class="token comment">// 2. Write something into the output</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Masks in OpenCV’s own functions are typically optional; that is, you can pass in <code>noArray()</code> and no masking operation will take place. We can do that in our function as well:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">void</span> <span class="token function">someFunction</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">,</span>
        OutputArray output<span class="token punctuation">,</span>
        InputArray mask <span class="token operator">=</span> <span class="token function">noArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mask<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. Use the mask on the input</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 2. Write something into the output</span>
<span class="token punctuation">}</span></code></pre></div>
<p>This is a trivial detail, but writing the function this way makes it so that if you don’t want a mask, you can just omit the parameter entirely instead of writing in <code>noArray()</code> yourself.</p>
<p>A more interesting case is the ability to make an <code>OutputArray</code> optional. Let’s suppose we’re writing a function that tells us how many closed edges it could find in an image (and for good measure, let’s use Revision 3 of the <code>preprocess</code> function we wrote earlier):</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">getNumberOfClosedEdges</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Mat processed<span class="token punctuation">,</span> edges<span class="token punctuation">;</span>
  <span class="token function">preprocess</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> processed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Canny</span><span class="token punctuation">(</span>processed<span class="token punctuation">,</span> edges<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Imaginary function that returns the number</span>
  <span class="token comment">// of closed edges in `edges`</span>
  <span class="token keyword">return</span> <span class="token function">numberOfClosedEdges</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>All we care about when we’re using this function is the number of closed edges. However, you can use the result of the Canny edge detection (<code>edges</code>) for visualization purposes or other processing tasks later on, so wouldn’t it be nice if we could optionally choose to keep it?</p>
<p><code>OutputArray</code> has a read-only <code>needed()</code> property, which returns <code>false</code> if its backing object is a <code>noArray()</code> instance. Let’s use that with our function:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">getNumberOfClosedEdges</span><span class="token punctuation">(</span>InputArray input<span class="token punctuation">,</span>
        OutputArray outputEdges <span class="token operator">=</span> <span class="token function">noArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Mat processed<span class="token punctuation">,</span> edges<span class="token punctuation">;</span>
  <span class="token function">preprocess</span><span class="token punctuation">(</span>input<span class="token punctuation">,</span> processed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">Canny</span><span class="token punctuation">(</span>processed<span class="token punctuation">,</span> edges<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>outputEdges<span class="token punctuation">.</span><span class="token function">needed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    edges<span class="token punctuation">.</span><span class="token function">copyTo</span><span class="token punctuation">(</span>outputEdges<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Imaginary function that returns the number</span>
  <span class="token comment">// of closed edges in `edges`</span>
  <span class="token keyword">return</span> <span class="token function">numberOfClosedEdges</span><span class="token punctuation">(</span>edges<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now we have an optional parameter to write the Canny results into if we want them. This technique is particularly useful for cases where you have an image processing pipeline with several steps and you want to store intermediates for visualization or debugging.</p>
<h2 id="links" style="position:relative;"><a href="#links" aria-label="links permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Links</h2>
<ul class="bullet-list">
<li><a href="https://github.com/opencv/opencv/wiki/Coding_Style_Guide">Coding Style Guide · opencv/opencv Wiki · GitHub</a></li>
<li><a href="https://docs.opencv.org/4.0.1/d4/d32/classcv_1_1__InputArray.html#details">InputArray - OpenCV Docs</a></li>
<li><a href="https://docs.opencv.org/4.0.1/d2/d9e/classcv_1_1__OutputArray.html#details">OutputArray - OpenCV Docs</a></li>
</ul></section></article></main></div></div></div></div></div><div id="gatsby-announcer" style="position: absolute; top: 0px; width: 1px; height: 1px; padding: 0px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0px;" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/opencv-tip-arrays/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-ea100fe6f02bbc648246.js"],"app":["/app-9ccce7c97793f07a9b8f.js"],"component---src-pages-404-js":["/component---src-pages-404-js-c3131affcb18a6be673b.js"],"component---src-pages-apps-index-js":["/component---src-pages-apps-index-js-074336a16d228c42481f.js"],"component---src-pages-blog-index-js":["/component---src-pages-blog-index-js-88f8d0a956e17435f1a8.js"],"component---src-pages-index-js":["/component---src-pages-index-js-55d2e30e1a121d0a029e.js"],"component---src-pages-projects-index-js":["/component---src-pages-projects-index-js-1cfa78940546ec28181c.js"],"component---src-templates-app-page-js":["/component---src-templates-app-page-js-ca050cdc6ae795d53a8f.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-313d8220c9e9c9688b4d.js"],"component---src-templates-project-page-js":["/component---src-templates-project-page-js-80ece2069d138aa6c838.js"]};/*]]>*/</script><script src="/polyfill-ea100fe6f02bbc648246.js" noModule></script><script src="/component---src-templates-blog-post-js-313d8220c9e9c9688b4d.js" async></script><script src="/commons-7a18c21993c24c3c9205.js" async></script><script src="/app-9ccce7c97793f07a9b8f.js" async></script><script src="/framework-25add98bf20cee191708.js" async></script><script src="/webpack-runtime-a1410d557796a525b231.js" async></script></body></html>